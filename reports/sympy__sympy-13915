[{"repo": "sympy/sympy", "instance_id": "sympy__sympy-13915", "base_commit": "5c1644ff85e15752f9f8721bc142bfbf975e7805", "patch": "diff --git a/sympy/core/mul.py b/sympy/core/mul.py\n--- a/sympy/core/mul.py\n+++ b/sympy/core/mul.py\n@@ -423,6 +423,11 @@ def _gather(c_powers):\n             changed = False\n             for b, e in c_powers:\n                 if e.is_zero:\n+                    # canceling out infinities yields NaN\n+                    if (b.is_Add or b.is_Mul) and any(infty in b.args\n+                        for infty in (S.ComplexInfinity, S.Infinity,\n+                                      S.NegativeInfinity)):\n+                        return [S.NaN], [], None\n                     continue\n                 if e is S.One:\n                     if b.is_Number:\n", "test_patch": "diff --git a/sympy/core/tests/test_arit.py b/sympy/core/tests/test_arit.py\n--- a/sympy/core/tests/test_arit.py\n+++ b/sympy/core/tests/test_arit.py\n@@ -1,7 +1,7 @@\n from __future__ import division\n \n from sympy import (Basic, Symbol, sin, cos, exp, sqrt, Rational, Float, re, pi,\n-        sympify, Add, Mul, Pow, Mod, I, log, S, Max, symbols, oo, Integer,\n+        sympify, Add, Mul, Pow, Mod, I, log, S, Max, symbols, oo, zoo, Integer,\n         sign, im, nan, Dummy, factorial, comp, refine\n )\n from sympy.core.compatibility import long, range\n@@ -1937,6 +1937,14 @@ def test_Mul_with_zero_infinite():\n     assert e.is_positive is None\n     assert e.is_hermitian is None\n \n+def test_Mul_does_not_cancel_infinities():\n+    a, b = symbols('a b')\n+    assert ((zoo + 3*a)/(3*a + zoo)) is nan\n+    assert ((b - oo)/(b - oo)) is nan\n+    # issue 13904\n+    expr = (1/(a+b) + 1/(a-b))/(1/(a+b) - 1/(a-b))\n+    assert expr.subs(b, a) is nan\n+\n def test_issue_8247_8354():\n     from sympy import tan\n     z = sqrt(1 + sqrt(3)) + sqrt(3 + 3*sqrt(3)) - sqrt(10 + 6*sqrt(3))\n", "problem_statement": "Issue with a substitution that leads to an undefined expression\n```\r\nPython 3.6.4 |Anaconda custom (64-bit)| (default, Dec 21 2017, 15:39:08) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 6.2.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: from sympy import *\r\n\r\nIn [2]: a,b = symbols('a,b')\r\n\r\nIn [3]: r = (1/(a+b) + 1/(a-b))/(1/(a+b) - 1/(a-b))\r\n\r\nIn [4]: r.subs(b,a)\r\nOut[4]: 1\r\n\r\nIn [6]: import sympy\r\n\r\nIn [7]: sympy.__version__\r\nOut[7]: '1.1.1'\r\n```\r\n\r\nIf b is substituted by a, r is undefined. It is possible to calculate the limit\r\n`r.limit(b,a) # -1`\r\n\r\nBut whenever a subexpression of r is undefined, r itself is undefined.\n", "hints_text": "In this regard, don't you think that `r.simplify()` is wrong? It returns `-a/b` which is not correct if b=a.\n`simplify` works for the generic case. SymPy would be hard to use if getting a+b from `simplify((a**2-b**2)/(a-b))` required an explicit declaration that a is not equal to b. (Besides, there is currently no way to express that declaration to `simplify`, anyway). This is part of reason we avoid `simplify` in code:  it can change the outcome in edge cases. \r\n\r\nThe fundamental issue here is: for what kind of expression `expr` do we want expr/expr to return 1? Current behavior:\r\n\r\nzoo / zoo   # nan\r\n(zoo + 3) / (zoo + 3)   # nan\r\n(zoo + a) / (zoo + a)    # 1  \r\n(zoo + a) / (a - zoo)   # 1 because -zoo is zoo  (zoo is complex infinity)  \r\n\r\nThe rules for combining an expression with its inverse in Mul appear to be too lax. \r\n\r\nThere is a check of the form `if something is S.ComplexInfinity`... which returns nan in the first two cases, but this condition is not met by `zoo + a`. \r\n\r\nBut using something like `numerator.is_finite` would not work either, because most of the time, we don't know if a symbolic expression is finite. E.g., `(a+b).is_finite` is None, unknown,  unless the symbols were explicitly declared to be finite.\r\n\r\nMy best idea so far is to have three cases for expr/expr: \r\n\r\n1. expr is infinite or 0: return nan\r\n2. Otherwise, if expr contains infinities (how to check this efficiently? Mul needs to be really fast), return expr/expr without combining \r\n3. Otherwise, return 1\n\"But using something like numerator.is_finite would not work either\"\r\n\r\nI had thought of something like denom.is_zero. If in expr_1/expr_2 the denominator is zero, the fraction is undefined. The only way to get a value from this is to use limits. At least i would think so.\r\n\r\nMy first idea was that sympy first simplifies and then substitutes. But then, the result should be -1. \r\n\r\n(zoo+a)/(a-zoo) # 1\r\nexplains what happens, but i had expected, that\r\nzoo/expr leads to nan and expr/zoo leads to nan as well.\r\n\r\nI agree, that Mul needs to be really fast, but this is about subst. But i confess, i don't know much about symbolic math.\nzoo/3 is zoo, and 4/zoo is 0. I think it's convenient, and not controversial, to have these. \r\n\r\nSubstitution is not to blame: it replaces b by a as requested, evaluating 1/(a-a) as zoo.  This is how `r` becomes `(1/(2*a) + zoo) / (1/(2*a) - zoo)`. So far nothing wrong has happened. The problem is that (because of -zoo being same as zoo) both parts are identified as the same and then the `_gather` helper of Mul method combines the powers 1 and -1 into power 0. And anything to power 0 returns 1 in SymPy, hence the result. \r\n\r\nI think we should prevent combining powers when base contains Infinity or ComplexInfinity. For example, (x+zoo) / (x+zoo)**2  returning 1 / (x+zoo) isn't right either. \nI dont really understand what happens. How can i get the result zoo? \r\n\r\nIn my example `r.subs(b,a)` returns ` 1`,  \r\nbut `r.subs(b,-a)` returns `(zoo + 1/(2*a))/(zoo - 1/(2*a))`\r\n\r\nSo how is zoo defined? Is it `(1/z).limit(z,0)`? I get `oo` as result, but how is this related to  `zoo`? As far as i know, `zoo` is ComplexInfinity. By playing around, i just found another confusing result:\r\n\r\n`(zoo+z)/(zoo-z)` returns `(z + zoo)/(-z + zoo)`, \r\nbut\r\n`(z + zoo)/(z-zoo)` returns 1\r\n\r\nI just found, `1/S.Zero` returns `zoo`, as well as `(1/S.Zero)**2`. To me, that would mean i should not divide by `zoo`.\nThere are three infinities: positive infinity oo, negative infinity -oo, and complex infinity zoo. Here is the difference:\r\n\r\n- If z is a positive number that tends to zero, then 1/z tends to oo\r\n- if z is a negative number than tends to zero, then 1/z tends to -oo\r\n- If z is a complex number that tends to zero, then 1/z tends to zoo\r\n\r\nThe complex infinity zoo does not have a determined sign, so -zoo is taken to  be the same as zoo. So when you put `(z + zoo)/(z-zoo)` two things happen: first, z-zoo returns z+zoo (you can check this directly) and second, the two identical expressions are cancelled, leaving 1.\r\n\r\nHowever, in (zoo+z)/(zoo-z) the terms are not identical, so they do not cancel. \r\n\r\nI am considering a solution that returns NaN when Mul cancels an expression with infinity of any kind. So for example (z+zoo)/(z+zoo) and (z-oo)/(z-oo) both return NaN. However, it changes the behavior in a couple of tests, so I have to investigate whether the tests are being wrong about infinities, or something else is. \nOk. I think i got it. Thank you for your patient explanation. \r\nMaybe one last question. Should `z + zoo` result in `zoo`? I think that would be natural.", "created_at": "2018-01-13T20:41:07Z", "version": "1.1", "FAIL_TO_PASS": "[\"test_Mul_does_not_cancel_infinities\"]", "PASS_TO_PASS": "[\"test_bug1\", \"test_Symbol\", \"test_arit0\", \"test_pow2\", \"test_pow3\", \"test_mod_pow\", \"test_pow_E\", \"test_pow_issue_3516\", \"test_pow_im\", \"test_real_mul\", \"test_ncmul\", \"test_ncpow\", \"test_powerbug\", \"test_Mul_doesnt_expand_exp\", \"test_Add_Mul_is_integer\", \"test_Add_Mul_is_finite\", \"test_Mul_is_even_odd\", \"test_evenness_in_ternary_integer_product_with_even\", \"test_oddness_in_ternary_integer_product_with_even\", \"test_Mul_is_rational\", \"test_Add_is_rational\", \"test_Add_is_even_odd\", \"test_Mul_is_negative_positive\", \"test_Mul_is_negative_positive_2\", \"test_Mul_is_nonpositive_nonnegative\", \"test_Pow_is_zero\", \"test_Mul_hermitian_antihermitian\", \"test_Add_is_comparable\", \"test_Mul_is_comparable\", \"test_Pow_is_comparable\", \"test_Add_is_positive_2\", \"test_Add_is_irrational\", \"test_issue_3531b\", \"test_bug3\", \"test_suppressed_evaluation\", \"test_Add_as_coeff_mul\", \"test_Pow_as_coeff_mul_doesnt_expand\", \"test_issue_3514\", \"test_make_args\", \"test_issue_5126\", \"test_Rational_as_content_primitive\", \"test_Add_as_content_primitive\", \"test_Mul_as_content_primitive\", \"test_Pow_as_content_primitive\", \"test_issue_5460\", \"test_product_irrational\", \"test_issue_5919\", \"test_Mod_is_integer\", \"test_issue_6001\", \"test_polar\", \"test_issue_6040\", \"test_issue_6082\", \"test_issue_6077\", \"test_mul_flatten_oo\", \"test_add_flatten\", \"test_issue_5160_6087_6089_6090\", \"test_float_int\", \"test_issue_6611a\", \"test_denest_add_mul\", \"test_mul_zero_detection\", \"test_Mul_with_zero_infinite\", \"test_issue_8247_8354\"]", "environment_setup_commit": "ec9e3c0436fbff934fa84e22bf07f1b3ef5bfac3"}, "On branch master\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   sympy/core/mul.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit 5c1644ff85e15752f9f8721bc142bfbf975e7805\nMerge: 726e3ddff1 2ec7166dc1\nAuthor: Aaron Meurer <asmeurer@gmail.com>\nDate:   Sat Jan 13 13:20:52 2018 -0600\n\n    Merge pull request #13909 from normalhuman/better_polylog_test\n    \n    Use verify_numerically in testing polylog expansions\n\ndiff --git a/sympy/core/mul.py b/sympy/core/mul.py\nindex 4f01eeedbd..29e6085ce3 100644\n--- a/sympy/core/mul.py\n+++ b/sympy/core/mul.py\n@@ -423,6 +423,11 @@ def _gather(c_powers):\n             changed = False\n             for b, e in c_powers:\n                 if e.is_zero:\n+                    # canceling out infinities yields NaN\n+                    if (b.is_Add or b.is_Mul) and any(infty in b.args\n+                        for infty in (S.ComplexInfinity, S.Infinity,\n+                                      S.NegativeInfinity)):\n+                        return [S.NaN], [], None\n                     continue\n                 if e is S.One:\n                     if b.is_Number:\nObtaining file:///testbed\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nRequirement already satisfied: mpmath>=0.19 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from sympy==1.1.2.dev0) (1.3.0)\nInstalling collected packages: sympy\n  Attempting uninstall: sympy\n    Found existing installation: sympy 1.1.2.dev0\n    Uninstalling sympy-1.1.2.dev0:\n      Successfully uninstalled sympy-1.1.2.dev0\n  Running setup.py develop for sympy\nSuccessfully installed sympy\n============================= test process starts ==============================\nexecutable:         /opt/miniconda3/envs/testbed/bin/python  (3.9.20-final-0) [CPython]\narchitecture:       64-bit\ncache:              no\nground types:       python \nnumpy:              None\nrandom seed:        33592490\nhash randomization: off\n\nsympy/core/tests/test_arit.py[82] \ntest_bug1 ok\ntest_Symbol ok\ntest_arit0 ok\ntest_div E\ntest_pow E\ntest_pow2 ok\ntest_pow3 ok\ntest_mod_pow ok\ntest_pow_E ok\ntest_pow_issue_3516 ok\ntest_pow_im ok\ntest_real_mul ok\ntest_ncmul ok\ntest_ncpow ok\ntest_powerbug ok\ntest_Mul_doesnt_expand_exp ok\ntest_Add_Mul_is_integer ok\ntest_Add_Mul_is_finite ok\ntest_Mul_is_even_odd ok\ntest_evenness_in_ternary_integer_product_with_odd f\ntest_evenness_in_ternary_integer_product_with_even ok\ntest_oddness_in_ternary_integer_product_with_odd f\ntest_oddness_in_ternary_integer_product_with_even ok\ntest_Mul_is_rational ok\ntest_Add_is_rational ok\ntest_Add_is_even_odd ok\ntest_Mul_is_negative_positive ok\ntest_Mul_is_negative_positive_2 ok\ntest_Mul_is_nonpositive_nonnegative ok\ntest_Add_is_negative_positive E\ntest_Add_is_nonpositive_nonnegative E\ntest_Pow_is_integer E\ntest_Pow_is_real E\ntest_real_Pow E\ntest_Pow_is_finite E\ntest_Pow_is_even_odd E\ntest_Pow_is_negative_positive E\ntest_Pow_is_zero ok\ntest_Pow_is_nonpositive_nonnegative E\ntest_Mul_is_imaginary_real E\ntest_Mul_hermitian_antihermitian ok\ntest_Add_is_comparable ok\ntest_Mul_is_comparable ok\ntest_Pow_is_comparable ok\ntest_Add_is_positive_2 ok\ntest_Add_is_irrational ok\ntest_issue_3531 f\ntest_issue_3531b ok\ntest_bug3 ok\ntest_suppressed_evaluation ok\ntest_Add_as_coeff_mul ok\ntest_Pow_as_coeff_mul_doesnt_expand ok\ntest_issue_3514 ok\ntest_make_args ok\ntest_issue_5126 ok\ntest_Rational_as_content_primitive ok\ntest_Add_as_content_primitive ok\ntest_Mul_as_content_primitive ok\ntest_Pow_as_content_primitive ok\ntest_issue_5460 ok\ntest_product_irrational ok\ntest_issue_5919 ok\ntest_Mod E\ntest_Mod_is_integer ok\ntest_Mod_is_nonposneg E\ntest_issue_6001 ok\ntest_polar ok\ntest_issue_6040 ok\ntest_issue_6082 ok\ntest_issue_6077 ok\ntest_mul_flatten_oo ok\ntest_add_flatten ok\ntest_issue_5160_6087_6089_6090 ok\ntest_float_int ok\ntest_issue_6611a ok\ntest_denest_add_mul ok\ntest_mul_coeff E\ntest_mul_zero_detection ok\ntest_Mul_with_zero_infinite ok\ntest_Mul_does_not_cancel_infinities ok\ntest_issue_8247_8354 ok\ntest_Add_is_zero ok                                                       [FAIL]\n\n\n________________________________________________________________________________\n____________________ sympy/core/tests/test_arit.py:test_div ____________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 102, in test_div\n    e = (1 - b)/(b - 1)\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 177, in __div__\n    return Mul(self, Pow(other, S.NegativeOne))\n  File \"/testbed/sympy/core/operations.py\", line 42, in __new__\n    c_part, nc_part, order_symbols = cls.flatten(args)\n  File \"/testbed/sympy/core/mul.py\", line 184, in flatten\n    if not a.is_zero and a.is_Rational:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 660, in _eval_is_nonpositive\n    if s != self and s.is_nonpositive:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 663, in _eval_is_nonpositive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n____________________ sympy/core/tests/test_arit.py:test_pow ____________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 141, in test_pow\n    assert e.diff(a) == 2*b*sqrt(5)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_________ sympy/core/tests/test_arit.py:test_Add_is_negative_positive __________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 782, in test_Add_is_negative_positive\n    assert (k - 2).is_negative is True\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 676, in _eval_is_negative\n    if s != self and s.is_negative and a.is_nonpositive:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 679, in _eval_is_negative\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n______ sympy/core/tests/test_arit.py:test_Add_is_nonpositive_nonnegative _______\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 865, in test_Add_is_nonpositive_nonnegative\n    assert (u - 2).is_nonpositive is None\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 679, in _eval_is_negative\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n______________ sympy/core/tests/test_arit.py:test_Pow_is_integer _______________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 945, in test_Pow_is_integer\n    assert ((m + 1)**(-2)).is_integer is False\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 431, in _eval_is_integer\n    if fuzzy_not((b - 1).is_zero) and fuzzy_not((b + 1).is_zero):\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 679, in _eval_is_negative\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n________________ sympy/core/tests/test_arit.py:test_Pow_is_real ________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1024, in test_Pow_is_real\n    assert (exp(i)**I).is_real is True\n  File \"/testbed/sympy/core/expr.py\", line 154, in __pow__\n    return self._pow(other)\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 150, in _pow\n    return Pow(self, other)\n  File \"/testbed/sympy/core/power.py\", line 227, in __new__\n    obj = b._eval_power(e)\n  File \"/testbed/sympy/functions/elementary/exponential.py\", line 108, in _eval_power\n    return Pow._eval_power(Pow(b, e, evaluate=False), other)\n  File \"/testbed/sympy/core/power.py\", line 331, in _eval_power\n    if s.is_real and _n2(sign(s) - s) == 0:\n  File \"/testbed/sympy/core/power.py\", line 283, in _n2\n    rv = e.evalf(2, strict=True)\n  File \"/testbed/sympy/core/evalf.py\", line 1403, in evalf\n    v = self._eval_evalf(prec)\n  File \"/testbed/sympy/core/operations.py\", line 305, in _eval_evalf\n    x, tail = self.as_independent(Symbol, AppliedUndef)\n  File \"/testbed/sympy/core/expr.py\", line 1670, in as_independent\n    if self.is_zero:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 592, in _eval_is_positive\n    if s != self and s.is_positive and a.is_nonnegative:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 592, in _eval_is_positive\n    if s != self and s.is_positive and a.is_nonnegative:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_________________ sympy/core/tests/test_arit.py:test_real_Pow __________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1039, in test_real_Pow\n    assert (k**(I*pi/log(k))).is_real\n  File \"/testbed/sympy/core/expr.py\", line 154, in __pow__\n    return self._pow(other)\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 150, in _pow\n    return Pow(self, other)\n  File \"/testbed/sympy/core/power.py\", line 220, in __new__\n    return S.Exp1**(c*numer(ex))\n  File \"/testbed/sympy/core/expr.py\", line 154, in __pow__\n    return self._pow(other)\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 150, in _pow\n    return Pow(self, other)\n  File \"/testbed/sympy/core/power.py\", line 227, in __new__\n    obj = b._eval_power(e)\n  File \"/testbed/sympy/core/numbers.py\", line 3450, in _eval_power\n    return exp(expt)\n  File \"/testbed/sympy/core/function.py\", line 439, in __new__\n    result = super(Function, cls).__new__(cls, *args, **options)\n  File \"/testbed/sympy/core/function.py\", line 250, in __new__\n    evaluated = cls.eval(*args)\n  File \"/testbed/sympy/functions/elementary/exponential.py\", line 251, in eval\n    if ask(Q.integer(2*coeff)):\n  File \"/testbed/sympy/assumptions/ask.py\", line 1247, in ask\n    from sympy.assumptions.satask import satask\n  File \"/testbed/sympy/assumptions/satask.py\", line 9, in <module>\n    from sympy.assumptions.sathandlers import fact_registry\n  File \"/testbed/sympy/assumptions/sathandlers.py\", line 3, in <module>\n    from collections import MutableMapping, defaultdict\n  File \"<frozen importlib._bootstrap>\", line 1055, in _handle_fromlist\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_______________ sympy/core/tests/test_arit.py:test_Pow_is_finite _______________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1049, in test_Pow_is_finite\n    assert (p**x).is_finite is None  # ditto\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  [Previous line repeated 2 more times]\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 1130, in _eval_is_algebraic\n    if self.base.is_zero or _is_one(self.base):\n  File \"/testbed/sympy/core/power.py\", line 1125, in _is_one\n    return (expr - 1).is_zero\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 645, in _eval_is_nonnegative\n    if s != self and s.is_nonnegative:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 648, in _eval_is_nonnegative\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n______________ sympy/core/tests/test_arit.py:test_Pow_is_even_odd ______________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1069, in test_Pow_is_even_odd\n    assert ((-1)**(m - p)).is_odd\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 172, in __rpow__\n    return Pow(other, self)\n  File \"/testbed/sympy/core/power.py\", line 227, in __new__\n    obj = b._eval_power(e)\n  File \"/testbed/sympy/core/numbers.py\", line 2616, in _eval_power\n    if expt.is_odd:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 564, in _eval_is_odd\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/add.py\", line 564, in <listcomp>\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1324, in _eval_is_even\n    return fuzzy_not(self.is_odd)\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1309, in _eval_is_odd\n    elif acc != 1 and (acc + t).is_odd:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_________ sympy/core/tests/test_arit.py:test_Pow_is_negative_positive __________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1129, in test_Pow_is_negative_positive\n    assert ((-k)**r).is_positive is None\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  [Previous line repeated 6 more times]\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 1130, in _eval_is_algebraic\n    if self.base.is_zero or _is_one(self.base):\n  File \"/testbed/sympy/core/power.py\", line 1125, in _is_one\n    return (expr - 1).is_zero\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 564, in _eval_is_odd\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/add.py\", line 564, in <listcomp>\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1324, in _eval_is_even\n    return fuzzy_not(self.is_odd)\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1309, in _eval_is_odd\n    elif acc != 1 and (acc + t).is_odd:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n______ sympy/core/tests/test_arit.py:test_Pow_is_nonpositive_nonnegative _______\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1187, in test_Pow_is_nonpositive_nonnegative\n    assert (k**2).is_nonnegative is True\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 571, in _eval_is_composite\n    ((self.base-1).is_positive and (self.exp-1).is_positive or\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n___________ sympy/core/tests/test_arit.py:test_Mul_is_imaginary_real ___________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1241, in test_Mul_is_imaginary_real\n    assert (e**j).is_real is None\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  [Previous line repeated 5 more times]\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 1130, in _eval_is_algebraic\n    if self.base.is_zero or _is_one(self.base):\n  File \"/testbed/sympy/core/power.py\", line 1125, in _is_one\n    return (expr - 1).is_zero\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 555, in _eval_is_zero\n    if b.is_zero:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 645, in _eval_is_nonnegative\n    if s != self and s.is_nonnegative:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 648, in _eval_is_nonnegative\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n____________________ sympy/core/tests/test_arit.py:test_Mod ____________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1536, in test_Mod\n    assert (k**(-m) % k).func is Mod\n  File \"/testbed/sympy/core/decorators.py\", line 91, in __sympifyit_wrapper\n    return func(a, b)\n  File \"/testbed/sympy/core/decorators.py\", line 132, in binary_op_wrapper\n    return func(self, other)\n  File \"/testbed/sympy/core/expr.py\", line 190, in __mod__\n    return Mod(self, other)\n  File \"/testbed/sympy/core/function.py\", line 439, in __new__\n    result = super(Function, cls).__new__(cls, *args, **options)\n  File \"/testbed/sympy/core/function.py\", line 250, in __new__\n    evaluated = cls.eval(*args)\n  File \"/testbed/sympy/core/mod.py\", line 91, in eval\n    rv = doit(p, q)\n  File \"/testbed/sympy/core/mod.py\", line 41, in doit\n    if p.is_infinite or q.is_infinite or p is nan or q is nan:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  [Previous line repeated 3 more times]\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/power.py\", line 563, in _eval_is_prime\n    if self.base.is_integer and self.exp.is_integer and (self.exp-1).is_positive:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_____________ sympy/core/tests/test_arit.py:test_Mod_is_nonposneg ______________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1680, in test_Mod_is_nonposneg\n    assert Mod(n, k).is_nonnegative\n  File \"/testbed/sympy/core/function.py\", line 439, in __new__\n    result = super(Function, cls).__new__(cls, *args, **options)\n  File \"/testbed/sympy/core/function.py\", line 250, in __new__\n    evaluated = cls.eval(*args)\n  File \"/testbed/sympy/core/mod.py\", line 91, in eval\n    rv = doit(p, q)\n  File \"/testbed/sympy/core/mod.py\", line 78, in doit\n    if d.is_negative:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 564, in _eval_is_odd\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/add.py\", line 564, in <listcomp>\n    l = [f for f in self.args if not (f.is_even is True)]\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1324, in _eval_is_even\n    return fuzzy_not(self.is_odd)\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/mul.py\", line 1309, in _eval_is_odd\n    elif acc != 1 and (acc + t).is_odd:\n  File \"/testbed/sympy/core/assumptions.py\", line 248, in getit\n    return _ask(fact, self)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 303, in _ask\n    _ask(pk, obj)\n  File \"/testbed/sympy/core/assumptions.py\", line 291, in _ask\n    a = evaluate(obj)\n  File \"/testbed/sympy/core/add.py\", line 595, in _eval_is_positive\n    v = _monotonic_sign(self)\n  File \"/testbed/sympy/core/exprtools.py\", line 120, in _monotonic_sign\n    d = self.diff(x)\n  File \"/testbed/sympy/core/expr.py\", line 3009, in diff\n    return Derivative(self, *new_symbols, **assumptions)\n  File \"/testbed/sympy/core/function.py\", line 1246, in __new__\n    if isinstance(v, (collections.Iterable, Tuple, MatrixCommon, NDimArray)):\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n________________________________________________________________________________\n_________________ sympy/core/tests/test_arit.py:test_mul_coeff _________________\n  File \"/testbed/sympy/core/tests/test_arit.py\", line 1852, in test_mul_coeff\n    p = exp(I*pi/3)\n  File \"/testbed/sympy/core/function.py\", line 439, in __new__\n    result = super(Function, cls).__new__(cls, *args, **options)\n  File \"/testbed/sympy/core/function.py\", line 250, in __new__\n    evaluated = cls.eval(*args)\n  File \"/testbed/sympy/functions/elementary/exponential.py\", line 251, in eval\n    if ask(Q.integer(2*coeff)):\n  File \"/testbed/sympy/assumptions/ask.py\", line 1247, in ask\n    from sympy.assumptions.satask import satask\n  File \"/testbed/sympy/assumptions/satask.py\", line 9, in <module>\n    from sympy.assumptions.sathandlers import fact_registry\n  File \"/testbed/sympy/assumptions/sathandlers.py\", line 3, in <module>\n    from collections import MutableMapping, defaultdict\n  File \"<frozen importlib._bootstrap>\", line 1055, in _handle_fromlist\n  File \"/opt/miniconda3/envs/testbed/lib/python3.9/collections/__init__.py\", line 62, in __getattr__\n    warnings.warn(\"Using or importing the ABCs from 'collections' instead \"\nDeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working\n\n tests finished: 64 passed, 3 expected to fail, 15 exceptions, in 2.33 seconds =\nDO *NOT* COMMIT!\n", {"sympy/core/tests/test_arit.py:test_div": "FAILED", "sympy/core/tests/test_arit.py:test_pow": "FAILED", "sympy/core/tests/test_arit.py:test_Add_is_negative_positive": "FAILED", "sympy/core/tests/test_arit.py:test_Add_is_nonpositive_nonnegative": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_integer": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_real": "FAILED", "sympy/core/tests/test_arit.py:test_real_Pow": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_finite": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_even_odd": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_negative_positive": "FAILED", "sympy/core/tests/test_arit.py:test_Pow_is_nonpositive_nonnegative": "FAILED", "sympy/core/tests/test_arit.py:test_Mul_is_imaginary_real": "FAILED", "sympy/core/tests/test_arit.py:test_Mod": "FAILED", "sympy/core/tests/test_arit.py:test_Mod_is_nonposneg": "FAILED", "sympy/core/tests/test_arit.py:test_mul_coeff": "FAILED", "test_bug1": "PASSED", "test_Symbol": "PASSED", "test_arit0": "PASSED", "test_div": "ERROR", "test_pow": "ERROR", "test_pow2": "PASSED", "test_pow3": "PASSED", "test_mod_pow": "PASSED", "test_pow_E": "PASSED", "test_pow_issue_3516": "PASSED", "test_pow_im": "PASSED", "test_real_mul": "PASSED", "test_ncmul": "PASSED", "test_ncpow": "PASSED", "test_powerbug": "PASSED", "test_Mul_doesnt_expand_exp": "PASSED", "test_Add_Mul_is_integer": "PASSED", "test_Add_Mul_is_finite": "PASSED", "test_Mul_is_even_odd": "PASSED", "test_evenness_in_ternary_integer_product_with_even": "PASSED", "test_oddness_in_ternary_integer_product_with_even": "PASSED", "test_Mul_is_rational": "PASSED", "test_Add_is_rational": "PASSED", "test_Add_is_even_odd": "PASSED", "test_Mul_is_negative_positive": "PASSED", "test_Mul_is_negative_positive_2": "PASSED", "test_Mul_is_nonpositive_nonnegative": "PASSED", "test_Add_is_negative_positive": "ERROR", "test_Add_is_nonpositive_nonnegative": "ERROR", "test_Pow_is_integer": "ERROR", "test_Pow_is_real": "ERROR", "test_real_Pow": "ERROR", "test_Pow_is_finite": "ERROR", "test_Pow_is_even_odd": "ERROR", "test_Pow_is_negative_positive": "ERROR", "test_Pow_is_zero": "PASSED", "test_Pow_is_nonpositive_nonnegative": "ERROR", "test_Mul_is_imaginary_real": "ERROR", "test_Mul_hermitian_antihermitian": "PASSED", "test_Add_is_comparable": "PASSED", "test_Mul_is_comparable": "PASSED", "test_Pow_is_comparable": "PASSED", "test_Add_is_positive_2": "PASSED", "test_Add_is_irrational": "PASSED", "test_issue_3531b": "PASSED", "test_bug3": "PASSED", "test_suppressed_evaluation": "PASSED", "test_Add_as_coeff_mul": "PASSED", "test_Pow_as_coeff_mul_doesnt_expand": "PASSED", "test_issue_3514": "PASSED", "test_make_args": "PASSED", "test_issue_5126": "PASSED", "test_Rational_as_content_primitive": "PASSED", "test_Add_as_content_primitive": "PASSED", "test_Mul_as_content_primitive": "PASSED", "test_Pow_as_content_primitive": "PASSED", "test_issue_5460": "PASSED", "test_product_irrational": "PASSED", "test_issue_5919": "PASSED", "test_Mod": "ERROR", "test_Mod_is_integer": "PASSED", "test_Mod_is_nonposneg": "ERROR", "test_issue_6001": "PASSED", "test_polar": "PASSED", "test_issue_6040": "PASSED", "test_issue_6082": "PASSED", "test_issue_6077": "PASSED", "test_mul_flatten_oo": "PASSED", "test_add_flatten": "PASSED", "test_issue_5160_6087_6089_6090": "PASSED", "test_float_int": "PASSED", "test_issue_6611a": "PASSED", "test_denest_add_mul": "PASSED", "test_mul_coeff": "ERROR", "test_mul_zero_detection": "PASSED", "test_Mul_with_zero_infinite": "PASSED", "test_Mul_does_not_cancel_infinities": "PASSED", "test_issue_8247_8354": "PASSED"}]