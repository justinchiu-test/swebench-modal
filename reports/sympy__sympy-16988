[{"repo": "sympy/sympy", "instance_id": "sympy__sympy-16988", "base_commit": "e727339af6dc22321b00f52d971cda39e4ce89fb", "patch": "diff --git a/sympy/sets/sets.py b/sympy/sets/sets.py\n--- a/sympy/sets/sets.py\n+++ b/sympy/sets/sets.py\n@@ -1260,7 +1260,7 @@ def __new__(cls, *args, **kwargs):\n         evaluate = kwargs.get('evaluate', global_evaluate[0])\n \n         # flatten inputs to merge intersections and iterables\n-        args = _sympify(args)\n+        args = list(ordered(set(_sympify(args))))\n \n         # Reduce sets using known rules\n         if evaluate:\n", "test_patch": "diff --git a/sympy/sets/tests/test_sets.py b/sympy/sets/tests/test_sets.py\n--- a/sympy/sets/tests/test_sets.py\n+++ b/sympy/sets/tests/test_sets.py\n@@ -21,7 +21,7 @@ def test_imageset():\n     assert imageset(x, abs(x), S.Integers) is S.Naturals0\n     # issue 16878a\n     r = symbols('r', real=True)\n-    assert (1, r) not in imageset(x, (x, x), S.Reals)\n+    assert (1, r) in imageset(x, (x, x), S.Reals) != False\n     assert (r, r) in imageset(x, (x, x), S.Reals)\n     assert 1 + I in imageset(x, x + I, S.Reals)\n     assert {1} not in imageset(x, (x,), S.Reals)\n@@ -342,6 +342,9 @@ def test_intersection():\n     # issue 12178\n     assert Intersection() == S.UniversalSet\n \n+    # issue 16987\n+    assert Intersection({1}, {1}, {x}) == Intersection({1}, {x})\n+\n \n def test_issue_9623():\n     n = Symbol('n')\n", "problem_statement": "Intersection should remove duplicates\n```python\r\n>>> Intersection({1},{1},{x})\r\nEmptySet()\r\n>>> Intersection({1},{x})\r\n{1}\r\n```\r\nThe answer should be `Piecewise(({1}, Eq(x, 1)), (S.EmptySet, True))` or remain unevaluated.\r\n\r\nThe routine should give the same answer if duplicates are present; my initial guess is that duplicates should just be removed at the outset of instantiation. Ordering them will produce canonical processing.\n", "hints_text": "", "created_at": "2019-06-07T12:00:00Z", "version": "1.5", "FAIL_TO_PASS": "[\"test_imageset\", \"test_intersection\"]", "PASS_TO_PASS": "[\"test_interval_arguments\", \"test_interval_symbolic_end_points\", \"test_union\", \"test_union_iter\", \"test_difference\", \"test_Complement\", \"test_complement\", \"test_intersect1\", \"test_issue_9623\", \"test_is_disjoint\", \"test_ProductSet_of_single_arg_is_arg\", \"test_interval_subs\", \"test_interval_to_mpi\", \"test_measure\", \"test_is_subset\", \"test_is_proper_subset\", \"test_is_superset\", \"test_is_proper_superset\", \"test_contains\", \"test_interval_symbolic\", \"test_union_contains\", \"test_is_number\", \"test_Interval_is_left_unbounded\", \"test_Interval_is_right_unbounded\", \"test_Interval_as_relational\", \"test_Finite_as_relational\", \"test_Union_as_relational\", \"test_Intersection_as_relational\", \"test_EmptySet\", \"test_finite_basic\", \"test_powerset\", \"test_product_basic\", \"test_real\", \"test_supinf\", \"test_universalset\", \"test_Union_of_ProductSets_shares\", \"test_Interval_free_symbols\", \"test_image_interval\", \"test_image_piecewise\", \"test_image_FiniteSet\", \"test_image_Union\", \"test_image_EmptySet\", \"test_issue_5724_7680\", \"test_boundary\", \"test_boundary_Union\", \"test_boundary_ProductSet\", \"test_boundary_ProductSet_line\", \"test_is_open\", \"test_is_closed\", \"test_closure\", \"test_interior\", \"test_issue_7841\", \"test_Eq\", \"test_SymmetricDifference\", \"test_issue_9536\", \"test_issue_9637\", \"test_issue_9956\", \"test_issue_Symbol_inter\", \"test_issue_11827\", \"test_issue_10113\", \"test_issue_10248\", \"test_issue_9447\", \"test_issue_10337\", \"test_issue_10326\", \"test_issue_2799\", \"test_issue_9706\", \"test_issue_8257\", \"test_issue_10931\", \"test_issue_11174\", \"test_finite_set_intersection\", \"test_union_intersection_constructor\", \"test_Union_contains\"]", "environment_setup_commit": "70381f282f2d9d039da860e391fe51649df2779d"}, "On branch master\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   sympy/sets/sets.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit e727339af6dc22321b00f52d971cda39e4ce89fb\nMerge: 6dd3966100 3c5b991bea\nAuthor: Francesco Bonazzi <franz.bonazzi@gmail.com>\nDate:   Fri Jun 7 09:45:12 2019 +0200\n\n    Merge pull request #16969 from kangzhiq/Added_functions_to_AC\n    \n    Added functions to ArrayComprehension\n\ndiff --git a/sympy/sets/sets.py b/sympy/sets/sets.py\nindex 03cf57a30b..e4d240919f 100644\n--- a/sympy/sets/sets.py\n+++ b/sympy/sets/sets.py\n@@ -1260,7 +1260,7 @@ def __new__(cls, *args, **kwargs):\n         evaluate = kwargs.get('evaluate', global_evaluate[0])\n \n         # flatten inputs to merge intersections and iterables\n-        args = _sympify(args)\n+        args = list(ordered(set(_sympify(args))))\n \n         # Reduce sets using known rules\n         if evaluate:\nObtaining file:///testbed\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nRequirement already satisfied: mpmath>=0.19 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from sympy==1.5.dev0) (1.3.0)\nInstalling collected packages: sympy\n  Attempting uninstall: sympy\n    Found existing installation: sympy 1.5.dev0\n    Uninstalling sympy-1.5.dev0:\n      Successfully uninstalled sympy-1.5.dev0\n  Running setup.py develop for sympy\nSuccessfully installed sympy\n============================= test process starts ==============================\nexecutable:         /opt/miniconda3/envs/testbed/bin/python  (3.9.20-final-0) [CPython]\narchitecture:       64-bit\ncache:              no\nground types:       python \nnumpy:              None\nrandom seed:        26277064\nhash randomization: off\n\nsympy/sets/tests/test_sets.py[78] \ntest_imageset ok\ntest_interval_arguments ok\ntest_interval_symbolic_end_points ok\ntest_union ok\ntest_union_iter ok\ntest_difference ok\ntest_Complement ok\ntest_complement ok\ntest_intersect1 ok\ntest_intersection ok\ntest_issue_9623 ok\ntest_is_disjoint ok\ntest_ProductSet_of_single_arg_is_arg ok\ntest_interval_subs ok\ntest_interval_to_mpi ok\ntest_measure ok\ntest_is_subset ok\ntest_is_proper_subset ok\ntest_is_superset ok\ntest_is_proper_superset ok\ntest_contains ok\ntest_interval_symbolic ok\ntest_union_contains ok\ntest_is_number ok\ntest_Interval_is_left_unbounded ok\ntest_Interval_is_right_unbounded ok\ntest_Interval_as_relational ok\ntest_Finite_as_relational ok\ntest_Union_as_relational ok\ntest_Intersection_as_relational ok\ntest_EmptySet ok\ntest_finite_basic ok\ntest_powerset ok\ntest_product_basic ok\ntest_real ok\ntest_supinf ok\ntest_universalset ok\ntest_Union_of_ProductSets_shares ok\ntest_Interval_free_symbols ok\ntest_image_interval ok\ntest_image_piecewise ok\ntest_image_Intersection f\ntest_image_FiniteSet ok\ntest_image_Union ok\ntest_image_EmptySet ok\ntest_issue_5724_7680 ok\ntest_boundary ok\ntest_boundary_Union ok\ntest_union_boundary_of_joining_sets f\ntest_boundary_ProductSet ok\ntest_boundary_ProductSet_line ok\ntest_is_open ok\ntest_is_closed ok\ntest_closure ok\ntest_interior ok\ntest_issue_7841 ok\ntest_Eq ok\ntest_SymmetricDifference ok\ntest_issue_9536 ok\ntest_issue_9637 ok\ntest_issue_9808 f\ntest_issue_9956 ok\ntest_issue_Symbol_inter ok\ntest_issue_11827 ok\ntest_issue_10113 ok\ntest_issue_10248 ok\ntest_issue_9447 ok\ntest_issue_10337 ok\ntest_issue_10326 ok\ntest_issue_2799 ok\ntest_issue_9706 ok\ntest_issue_8257 ok\ntest_issue_10931 ok\ntest_issue_11174 ok\ntest_finite_set_intersection ok\ntest_union_intersection_constructor ok\ntest_Union_contains ok\ntest_issue_16878b f                                                         [OK]\n\n\n________________________________ slowest tests _________________________________\ntest_image_interval - Took 33.900 seconds\ntest_issue_10113 - Took 50.570 seconds\n======= tests finished: 74 passed, 4 expected to fail, in 92.18 seconds ========\n", {"test_imageset": "PASSED", "test_interval_arguments": "PASSED", "test_interval_symbolic_end_points": "PASSED", "test_union": "PASSED", "test_union_iter": "PASSED", "test_difference": "PASSED", "test_Complement": "PASSED", "test_complement": "PASSED", "test_intersect1": "PASSED", "test_intersection": "PASSED", "test_issue_9623": "PASSED", "test_is_disjoint": "PASSED", "test_ProductSet_of_single_arg_is_arg": "PASSED", "test_interval_subs": "PASSED", "test_interval_to_mpi": "PASSED", "test_measure": "PASSED", "test_is_subset": "PASSED", "test_is_proper_subset": "PASSED", "test_is_superset": "PASSED", "test_is_proper_superset": "PASSED", "test_contains": "PASSED", "test_interval_symbolic": "PASSED", "test_union_contains": "PASSED", "test_is_number": "PASSED", "test_Interval_is_left_unbounded": "PASSED", "test_Interval_is_right_unbounded": "PASSED", "test_Interval_as_relational": "PASSED", "test_Finite_as_relational": "PASSED", "test_Union_as_relational": "PASSED", "test_Intersection_as_relational": "PASSED", "test_EmptySet": "PASSED", "test_finite_basic": "PASSED", "test_powerset": "PASSED", "test_product_basic": "PASSED", "test_real": "PASSED", "test_supinf": "PASSED", "test_universalset": "PASSED", "test_Union_of_ProductSets_shares": "PASSED", "test_Interval_free_symbols": "PASSED", "test_image_interval": "PASSED", "test_image_piecewise": "PASSED", "test_image_FiniteSet": "PASSED", "test_image_Union": "PASSED", "test_image_EmptySet": "PASSED", "test_issue_5724_7680": "PASSED", "test_boundary": "PASSED", "test_boundary_Union": "PASSED", "test_boundary_ProductSet": "PASSED", "test_boundary_ProductSet_line": "PASSED", "test_is_open": "PASSED", "test_is_closed": "PASSED", "test_closure": "PASSED", "test_interior": "PASSED", "test_issue_7841": "PASSED", "test_Eq": "PASSED", "test_SymmetricDifference": "PASSED", "test_issue_9536": "PASSED", "test_issue_9637": "PASSED", "test_issue_9956": "PASSED", "test_issue_Symbol_inter": "PASSED", "test_issue_11827": "PASSED", "test_issue_10113": "PASSED", "test_issue_10248": "PASSED", "test_issue_9447": "PASSED", "test_issue_10337": "PASSED", "test_issue_10326": "PASSED", "test_issue_2799": "PASSED", "test_issue_9706": "PASSED", "test_issue_8257": "PASSED", "test_issue_10931": "PASSED", "test_issue_11174": "PASSED", "test_finite_set_intersection": "PASSED", "test_union_intersection_constructor": "PASSED", "test_Union_contains": "PASSED"}]