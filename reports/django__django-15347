[{"repo": "django/django", "instance_id": "django__django-15347", "base_commit": "7c4f3965098baad2396e24501e09237425a7bd6f", "patch": "diff --git a/django/contrib/messages/storage/cookie.py b/django/contrib/messages/storage/cookie.py\n--- a/django/contrib/messages/storage/cookie.py\n+++ b/django/contrib/messages/storage/cookie.py\n@@ -19,7 +19,7 @@ def default(self, obj):\n             # Using 0/1 here instead of False/True to produce more compact json\n             is_safedata = 1 if isinstance(obj.message, SafeData) else 0\n             message = [self.message_key, is_safedata, obj.level, obj.message]\n-            if obj.extra_tags:\n+            if obj.extra_tags is not None:\n                 message.append(obj.extra_tags)\n             return message\n         return super().default(obj)\n", "test_patch": "diff --git a/tests/messages_tests/test_cookie.py b/tests/messages_tests/test_cookie.py\n--- a/tests/messages_tests/test_cookie.py\n+++ b/tests/messages_tests/test_cookie.py\n@@ -52,6 +52,12 @@ class CookieTests(BaseTests, SimpleTestCase):\n     def stored_messages_count(self, storage, response):\n         return stored_cookie_messages_count(storage, response)\n \n+    def encode_decode(self, *args, **kwargs):\n+        storage = self.get_storage()\n+        message = Message(constants.DEBUG, *args, **kwargs)\n+        encoded = storage._encode(message)\n+        return storage._decode(encoded)\n+\n     def test_get(self):\n         storage = self.storage_class(self.get_request())\n         # Set initial data.\n@@ -168,12 +174,23 @@ def test_safedata(self):\n         A message containing SafeData is keeping its safe status when\n         retrieved from the message storage.\n         \"\"\"\n-        def encode_decode(data):\n-            message = Message(constants.DEBUG, data)\n-            encoded = storage._encode(message)\n-            decoded = storage._decode(encoded)\n-            return decoded.message\n+        self.assertIsInstance(\n+            self.encode_decode(mark_safe('<b>Hello Django!</b>')).message,\n+            SafeData,\n+        )\n+        self.assertNotIsInstance(\n+            self.encode_decode('<b>Hello Django!</b>').message,\n+            SafeData,\n+        )\n \n-        storage = self.get_storage()\n-        self.assertIsInstance(encode_decode(mark_safe(\"<b>Hello Django!</b>\")), SafeData)\n-        self.assertNotIsInstance(encode_decode(\"<b>Hello Django!</b>\"), SafeData)\n+    def test_extra_tags(self):\n+        \"\"\"\n+        A message's extra_tags attribute is correctly preserved when retrieved\n+        from the message storage.\n+        \"\"\"\n+        for extra_tags in ['', None, 'some tags']:\n+            with self.subTest(extra_tags=extra_tags):\n+                self.assertEqual(\n+                    self.encode_decode('message', extra_tags=extra_tags).extra_tags,\n+                    extra_tags,\n+                )\n", "problem_statement": "Messages framework incorrectly serializes/deserializes extra_tags when it's an empty string\nDescription\n\t\nWhen a message is serialised and then deserialised with any of the built in storage backends, then extra_tags==\"\" is converted to extra_tags==None. This is because MessageEncoder checks for the truthyness of extra_tags rather than checking it is not None.\nTo replicate this bug\n>>> from django.conf import settings\n>>> settings.configure() # Just to allow the following import\n>>> from django.contrib.messages.storage.base import Message\n>>> from django.contrib.messages.storage.cookie import MessageEncoder, MessageDecoder\n>>> original_message = Message(10, \"Here is a message\", extra_tags=\"\")\n>>> encoded_message = MessageEncoder().encode(original_message)\n>>> decoded_message = MessageDecoder().decode(encoded_message)\n>>> original_message.extra_tags == \"\"\nTrue\n>>> decoded_message.extra_tags is None\nTrue\nEffect of the bug in application behaviour\nThis error occurred in the wild with a template tag similar to the following:\n{% if x not in message.extra_tags %}\nWhen the message was displayed as part of a redirect, it had been serialised and deserialized which meant that extra_tags was None instead of the empty string. This caused an error.\nIt's important to note that this bug affects all of the standard API (messages.debug, messages.info etc. all have a default value of extra_tags equal to \"\").\n", "hints_text": "", "created_at": "2022-01-22T01:56:48Z", "version": "4.1", "FAIL_TO_PASS": "[\"A message's extra_tags attribute is correctly preserved when retrieved\"]", "PASS_TO_PASS": "[\"test_add (messages_tests.test_cookie.CookieTests)\", \"test_add_lazy_translation (messages_tests.test_cookie.CookieTests)\", \"test_add_update (messages_tests.test_cookie.CookieTests)\", \"test_context_processor_message_levels (messages_tests.test_cookie.CookieTests)\", \"CookieStorage honors SESSION_COOKIE_DOMAIN, SESSION_COOKIE_SECURE, and\", \"test_custom_tags (messages_tests.test_cookie.CookieTests)\", \"test_default_level (messages_tests.test_cookie.CookieTests)\", \"test_existing_add (messages_tests.test_cookie.CookieTests)\", \"test_existing_add_read_update (messages_tests.test_cookie.CookieTests)\", \"Reading the existing storage doesn't cause the data to be lost.\", \"test_existing_read_add_update (messages_tests.test_cookie.CookieTests)\", \"With the message middleware enabled, messages are properly stored and\", \"test_get (messages_tests.test_cookie.CookieTests)\", \"test_get_bad_cookie (messages_tests.test_cookie.CookieTests)\", \"test_high_level (messages_tests.test_cookie.CookieTests)\", \"A complex nested data structure containing Message\", \"test_level_tag (messages_tests.test_cookie.CookieTests)\", \"test_low_level (messages_tests.test_cookie.CookieTests)\", \"If the data exceeds what is allowed in a cookie, older messages are\", \"test_message_rfc6265 (messages_tests.test_cookie.CookieTests)\", \"When the middleware is disabled, an exception is raised when one\", \"When the middleware is disabled, an exception is not raised\", \"Messages persist properly when multiple POSTs are made before a GET.\", \"test_no_update (messages_tests.test_cookie.CookieTests)\", \"test_repr (messages_tests.test_cookie.CookieTests)\", \"A message containing SafeData is keeping its safe status when\", \"test_settings_level (messages_tests.test_cookie.CookieTests)\", \"test_tags (messages_tests.test_cookie.CookieTests)\", \"test_with_template_response (messages_tests.test_cookie.CookieTests)\"]", "environment_setup_commit": "647480166bfe7532e8c471fef0146e3a17e6c0c9"}, "On branch main\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   django/contrib/messages/storage/cookie.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit 7c4f3965098baad2396e24501e09237425a7bd6f\nAuthor: Claude Paroz <claude@2xlibre.net>\nDate:   Fri Jan 21 15:46:37 2022 +0100\n\n    Stopped including type=\"text/css\" attributes for CSS link tags.\n\ndiff --git a/django/contrib/admin/templates/admin/auth/user/change_password.html b/django/contrib/admin/templates/admin/auth/user/change_password.html\nindex 730e4c5751..ed4285855e 100644\n--- a/django/contrib/admin/templates/admin/auth/user/change_password.html\n+++ b/django/contrib/admin/templates/admin/auth/user/change_password.html\n@@ -2,7 +2,7 @@\n {% load i18n static %}\n {% load admin_urls %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n {% block bodyclass %}{{ block.super }} {{ opts.app_label }}-{{ opts.model_name }} change-form{% endblock %}\n {% if not is_popup %}\n {% block breadcrumbs %}\ndiff --git a/django/contrib/admin/templates/admin/base.html b/django/contrib/admin/templates/admin/base.html\nindex 36899bc0d1..8ea3cd567c 100644\n--- a/django/contrib/admin/templates/admin/base.html\n+++ b/django/contrib/admin/templates/admin/base.html\n@@ -3,21 +3,21 @@\n <html lang=\"{{ LANGUAGE_CODE|default:\"en-us\" }}\" dir=\"{{ LANGUAGE_BIDI|yesno:'rtl,ltr,auto' }}\">\n <head>\n <title>{% block title %}{% endblock %}</title>\n-<link rel=\"stylesheet\" type=\"text/css\" href=\"{% block stylesheet %}{% static \"admin/css/base.css\" %}{% endblock %}\">\n+<link rel=\"stylesheet\" href=\"{% block stylesheet %}{% static \"admin/css/base.css\" %}{% endblock %}\">\n {% block dark-mode-vars %}\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/dark_mode.css\" %}\">\n+  <link rel=\"stylesheet\" href=\"{% static \"admin/css/dark_mode.css\" %}\">\n {% endblock %}\n {% if not is_popup and is_nav_sidebar_enabled %}\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/nav_sidebar.css\" %}\">\n+  <link rel=\"stylesheet\" href=\"{% static \"admin/css/nav_sidebar.css\" %}\">\n   <script src=\"{% static 'admin/js/nav_sidebar.js' %}\" defer></script>\n {% endif %}\n {% block extrastyle %}{% endblock %}\n-{% if LANGUAGE_BIDI %}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% block stylesheet_rtl %}{% static \"admin/css/rtl.css\" %}{% endblock %}\">{% endif %}\n+{% if LANGUAGE_BIDI %}<link rel=\"stylesheet\" href=\"{% block stylesheet_rtl %}{% static \"admin/css/rtl.css\" %}{% endblock %}\">{% endif %}\n {% block extrahead %}{% endblock %}\n {% block responsive %}\n     <meta name=\"viewport\" content=\"user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0\">\n-    <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/responsive.css\" %}\">\n-    {% if LANGUAGE_BIDI %}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/responsive_rtl.css\" %}\">{% endif %}\n+    <link rel=\"stylesheet\" href=\"{% static \"admin/css/responsive.css\" %}\">\n+    {% if LANGUAGE_BIDI %}<link rel=\"stylesheet\" href=\"{% static \"admin/css/responsive_rtl.css\" %}\">{% endif %}\n {% endblock %}\n {% block blockbots %}<meta name=\"robots\" content=\"NONE,NOARCHIVE\">{% endblock %}\n </head>\ndiff --git a/django/contrib/admin/templates/admin/change_form.html b/django/contrib/admin/templates/admin/change_form.html\nindex 21b1c9bceb..33343846bf 100644\n--- a/django/contrib/admin/templates/admin/change_form.html\n+++ b/django/contrib/admin/templates/admin/change_form.html\n@@ -6,7 +6,7 @@\n {{ media }}\n {% endblock %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n \n {% block coltype %}colM{% endblock %}\n \ndiff --git a/django/contrib/admin/templates/admin/change_list.html b/django/contrib/admin/templates/admin/change_list.html\nindex 15508a9a9f..12a495504f 100644\n--- a/django/contrib/admin/templates/admin/change_list.html\n+++ b/django/contrib/admin/templates/admin/change_list.html\n@@ -3,9 +3,9 @@\n \n {% block extrastyle %}\n   {{ block.super }}\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/changelists.css\" %}\">\n+  <link rel=\"stylesheet\" href=\"{% static \"admin/css/changelists.css\" %}\">\n   {% if cl.formset %}\n-    <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">\n+    <link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">\n   {% endif %}\n   {% if cl.formset or action_form %}\n     <script src=\"{% url 'admin:jsi18n' %}\"></script>\ndiff --git a/django/contrib/admin/templates/admin/index.html b/django/contrib/admin/templates/admin/index.html\nindex b6e84b64ed..5674264093 100644\n--- a/django/contrib/admin/templates/admin/index.html\n+++ b/django/contrib/admin/templates/admin/index.html\n@@ -1,7 +1,7 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n static %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/dashboard.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/dashboard.css\" %}\">{% endblock %}\n \n {% block coltype %}colMS{% endblock %}\n \ndiff --git a/django/contrib/admin/templates/admin/login.html b/django/contrib/admin/templates/admin/login.html\nindex 7a192a4bdf..aaa21fb450 100644\n--- a/django/contrib/admin/templates/admin/login.html\n+++ b/django/contrib/admin/templates/admin/login.html\n@@ -1,7 +1,7 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n static %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/login.css\" %}\">\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/login.css\" %}\">\n {{ form.media }}\n {% endblock %}\n \ndiff --git a/django/contrib/admin/templates/registration/password_change_form.html b/django/contrib/admin/templates/registration/password_change_form.html\nindex 95c84f922d..c79020180b 100644\n--- a/django/contrib/admin/templates/registration/password_change_form.html\n+++ b/django/contrib/admin/templates/registration/password_change_form.html\n@@ -1,6 +1,6 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n static %}\n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n {% block userlinks %}{% url 'django-admindocs-docroot' as docsroot %}{% if docsroot %}<a href=\"{{ docsroot }}\">{% translate 'Documentation' %}</a> / {% endif %} {% translate 'Change password' %} / <a href=\"{% url 'admin:logout' %}\">{% translate 'Log out' %}</a>{% endblock %}\n {% block breadcrumbs %}\n <div class=\"breadcrumbs\">\ndiff --git a/django/contrib/admin/templates/registration/password_reset_confirm.html b/django/contrib/admin/templates/registration/password_reset_confirm.html\nindex 373e703416..c93f9c4692 100644\n--- a/django/contrib/admin/templates/registration/password_reset_confirm.html\n+++ b/django/contrib/admin/templates/registration/password_reset_confirm.html\n@@ -1,7 +1,7 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n static %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n {% block breadcrumbs %}\n <div class=\"breadcrumbs\">\n <a href=\"{% url 'admin:index' %}\">{% translate 'Home' %}</a>\ndiff --git a/django/contrib/admin/templates/registration/password_reset_form.html b/django/contrib/admin/templates/registration/password_reset_form.html\nindex 33785f7c14..380441501e 100644\n--- a/django/contrib/admin/templates/registration/password_reset_form.html\n+++ b/django/contrib/admin/templates/registration/password_reset_form.html\n@@ -1,7 +1,7 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n static %}\n \n-{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n+{% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" href=\"{% static \"admin/css/forms.css\" %}\">{% endblock %}\n {% block breadcrumbs %}\n <div class=\"breadcrumbs\">\n <a href=\"{% url 'admin:index' %}\">{% translate 'Home' %}</a>\ndiff --git a/django/forms/widgets.py b/django/forms/widgets.py\nindex cb8fb5e92a..05667f8e44 100644\n--- a/django/forms/widgets.py\n+++ b/django/forms/widgets.py\n@@ -90,7 +90,7 @@ class Media:\n         media = sorted(self._css)\n         return chain.from_iterable([\n             format_html(\n-                '<link href=\"{}\" type=\"text/css\" media=\"{}\" rel=\"stylesheet\">',\n+                '<link href=\"{}\" media=\"{}\" rel=\"stylesheet\">',\n                 self.absolute_path(path), medium\n             ) for path in self._css[medium]\n         ] for medium in media)\ndiff --git a/django/views/templates/default_urlconf.html b/django/views/templates/default_urlconf.html\nindex ce1084ec4e..c85b478831 100644\n--- a/django/views/templates/default_urlconf.html\n+++ b/django/views/templates/default_urlconf.html\n@@ -6,7 +6,7 @@\n         <meta charset=\"utf-8\">\n         <title>{% translate \"The install worked successfully! Congratulations!\" %}</title>\n         <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n-        <link rel=\"stylesheet\" type=\"text/css\" href=\"/static/admin/css/fonts.css\">\n+        <link rel=\"stylesheet\" href=\"/static/admin/css/fonts.css\">\n         <style>\n           html {\n             line-height: 1.15;\ndiff --git a/docs/_theme/djangodocs/layout.html b/docs/_theme/djangodocs/layout.html\nindex c8770173aa..487c2b4922 100644\n--- a/docs/_theme/djangodocs/layout.html\n+++ b/docs/_theme/djangodocs/layout.html\n@@ -72,7 +72,7 @@\n </script>\n {% endif %}\n {%- if include_console_assets -%}\n-<link rel=\"stylesheet\" href=\"{{ pathto('_static/console-tabs.css', 1) }}\" type=\"text/css\" />\n+<link rel=\"stylesheet\" href=\"{{ pathto('_static/console-tabs.css', 1) }}\">\n {%- endif -%}\n {% endblock %}\n \ndiff --git a/docs/intro/tutorial06.txt b/docs/intro/tutorial06.txt\nindex c3df546cae..f0087f8905 100644\n--- a/docs/intro/tutorial06.txt\n+++ b/docs/intro/tutorial06.txt\n@@ -74,7 +74,7 @@ Next, add the following at the top of ``polls/templates/polls/index.html``:\n \n     {% load static %}\n \n-    <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static 'polls/style.css' %}\">\n+    <link rel=\"stylesheet\" href=\"{% static 'polls/style.css' %}\">\n \n The ``{% static %}`` template tag generates the absolute URL of static files.\n \ndiff --git a/docs/ref/templates/builtins.txt b/docs/ref/templates/builtins.txt\nindex 1fcfa1fa88..08c1ca47e2 100644\n--- a/docs/ref/templates/builtins.txt\n+++ b/docs/ref/templates/builtins.txt\n@@ -2637,7 +2637,7 @@ It is also able to consume standard context variables, e.g. assuming a\n ``user_stylesheet`` variable is passed to the template::\n \n     {% load static %}\n-    <link rel=\"stylesheet\" href=\"{% static user_stylesheet %}\" type=\"text/css\" media=\"screen\">\n+    <link rel=\"stylesheet\" href=\"{% static user_stylesheet %}\" media=\"screen\">\n \n If you'd like to retrieve a static URL without displaying it, you can use a\n slightly different call::\ndiff --git a/docs/releases/4.1.txt b/docs/releases/4.1.txt\nindex 8a531039ef..cf4eb07b35 100644\n--- a/docs/releases/4.1.txt\n+++ b/docs/releases/4.1.txt\n@@ -366,6 +366,9 @@ Miscellaneous\n   :attr:`~django.contrib.admin.ModelAdmin.inlines` attributes now default to an\n   empty tuple rather than an empty list to discourage unintended mutation.\n \n+* The ``type=\"text/css\"`` attribute is no longer included in ``<link>`` tags\n+  for CSS :doc:`form media </topics/forms/media>`.\n+\n .. _deprecated-features-4.1:\n \n Features deprecated in 4.1\ndiff --git a/docs/topics/forms/media.txt b/docs/topics/forms/media.txt\nindex 34bc70dcc5..6ca7c66fde 100644\n--- a/docs/topics/forms/media.txt\n+++ b/docs/topics/forms/media.txt\n@@ -71,7 +71,7 @@ can be retrieved through this property::\n \n     >>> w = CalendarWidget()\n     >>> print(w.media)\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n \n@@ -114,9 +114,14 @@ requirements::\n \n If this last CSS definition were to be rendered, it would become the following HTML::\n \n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"screen\" rel=\"stylesheet\">\n-    <link href=\"http://static.example.com/lo_res.css\" type=\"text/css\" media=\"tv,projector\" rel=\"stylesheet\">\n-    <link href=\"http://static.example.com/newspaper.css\" type=\"text/css\" media=\"print\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"screen\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/lo_res.css\" media=\"tv,projector\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/newspaper.css\" media=\"print\" rel=\"stylesheet\">\n+\n+.. versionchanged:: 4.1\n+\n+    In older versions, the ``type=\"text/css\"`` attribute is included in CSS\n+    links.\n \n ``js``\n ------\n@@ -145,8 +150,8 @@ example above::\n \n     >>> w = FancyCalendarWidget()\n     >>> print(w.media)\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-    <link href=\"http://static.example.com/fancy.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/fancy.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n     <script src=\"http://static.example.com/whizbang.js\"></script>\n@@ -165,7 +170,7 @@ an ``extend=False`` declaration to the ``Media`` declaration::\n \n     >>> w = FancyCalendarWidget()\n     >>> print(w.media)\n-    <link href=\"http://static.example.com/fancy.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/fancy.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/whizbang.js\"></script>\n \n If you require even more control over inheritance, define your assets using a\n@@ -228,7 +233,7 @@ was ``None``::\n \n     >>> w = CalendarWidget()\n     >>> print(w.media)\n-    <link href=\"/css/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"/css/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://uploads.example.com/animations.js\"></script>\n     <script src=\"http://othersite.com/actions.js\"></script>\n \n@@ -236,7 +241,7 @@ But if :setting:`STATIC_URL` is ``'http://static.example.com/'``::\n \n     >>> w = CalendarWidget()\n     >>> print(w.media)\n-    <link href=\"/css/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"/css/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://othersite.com/actions.js\"></script>\n \n@@ -245,7 +250,7 @@ Or if :mod:`~django.contrib.staticfiles` is configured using the\n \n     >>> w = CalendarWidget()\n     >>> print(w.media)\n-    <link href=\"/css/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"/css/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"https://static.example.com/animations.27e20196a850.js\"></script>\n     <script src=\"http://othersite.com/actions.js\"></script>\n \n@@ -268,12 +273,12 @@ operator to filter out a medium of interest. For example::\n \n     >>> w = CalendarWidget()\n     >>> print(w.media)\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n \n     >>> print(w.media['css'])\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n \n When you use the subscript operator, the value that is returned is a\n new ``Media`` object -- but one that only contains the media of interest.\n@@ -300,7 +305,7 @@ specified by both::\n     >>> w1 = CalendarWidget()\n     >>> w2 = OtherWidget()\n     >>> print(w1.media + w2.media)\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n     <script src=\"http://static.example.com/whizbang.js\"></script>\n@@ -356,7 +361,7 @@ are part of the form::\n \n     >>> f = ContactForm()\n     >>> f.media\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n     <script src=\"http://static.example.com/whizbang.js\"></script>\n@@ -375,8 +380,8 @@ CSS for form layout -- add a ``Media`` declaration to the form::\n \n     >>> f = ContactForm()\n     >>> f.media\n-    <link href=\"http://static.example.com/pretty.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-    <link href=\"http://static.example.com/layout.css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/pretty.css\" media=\"all\" rel=\"stylesheet\">\n+    <link href=\"http://static.example.com/layout.css\" media=\"all\" rel=\"stylesheet\">\n     <script src=\"http://static.example.com/animations.js\"></script>\n     <script src=\"http://static.example.com/actions.js\"></script>\n     <script src=\"http://static.example.com/whizbang.js\"></script>\ndiff --git a/tests/forms_tests/tests/test_media.py b/tests/forms_tests/tests/test_media.py\nindex 26f81a4602..d145560d9b 100644\n--- a/tests/forms_tests/tests/test_media.py\n+++ b/tests/forms_tests/tests/test_media.py\n@@ -17,8 +17,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         )\n         self.assertEqual(\n             str(m),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n@@ -38,8 +38,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         m3 = Media(Foo)\n         self.assertEqual(\n             str(m3),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n@@ -70,8 +70,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         w1 = MyWidget1()\n         self.assertEqual(\n             str(w1.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n@@ -80,8 +80,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         # Media objects can be interrogated by media type\n         self.assertEqual(\n             str(w1.media['css']),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\"\"\"\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\"\"\"\n         )\n \n         self.assertEqual(\n@@ -120,9 +120,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         w3 = MyWidget3()\n         self.assertEqual(\n             str(w1.media + w2.media + w3.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -132,8 +132,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         # media addition hasn't affected the original objects\n         self.assertEqual(\n             str(w1.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n@@ -148,7 +148,7 @@ class FormsMediaTestCase(SimpleTestCase):\n                 js = ('/path/to/js1', '/path/to/js1')\n \n         w4 = MyWidget4()\n-        self.assertEqual(str(w4.media), \"\"\"<link href=\"/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+        self.assertEqual(str(w4.media), \"\"\"<link href=\"/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\"\"\")\n \n     def test_media_deduplication(self):\n@@ -159,7 +159,7 @@ class FormsMediaTestCase(SimpleTestCase):\n             css={'all': ('/path/to/css1', '/path/to/css1')},\n             js=('/path/to/js1', '/path/to/js1'),\n         )\n-        self.assertEqual(str(media), \"\"\"<link href=\"/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+        self.assertEqual(str(media), \"\"\"<link href=\"/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\"\"\")\n \n     def test_media_property(self):\n@@ -174,7 +174,7 @@ class FormsMediaTestCase(SimpleTestCase):\n             media = property(_media)\n \n         w4 = MyWidget4()\n-        self.assertEqual(str(w4.media), \"\"\"<link href=\"/some/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+        self.assertEqual(str(w4.media), \"\"\"<link href=\"/some/path\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/some/js\"></script>\"\"\")\n \n         # Media properties can reference the media of their parents\n@@ -184,8 +184,8 @@ class FormsMediaTestCase(SimpleTestCase):\n             media = property(_media)\n \n         w5 = MyWidget5()\n-        self.assertEqual(str(w5.media), \"\"\"<link href=\"/some/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/other/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+        self.assertEqual(str(w5.media), \"\"\"<link href=\"/some/path\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/other/path\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/some/js\"></script>\n <script src=\"/other/js\"></script>\"\"\")\n \n@@ -207,9 +207,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         w6 = MyWidget6()\n         self.assertEqual(\n             str(w6.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/other/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/other/path\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"/other/js\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n@@ -235,8 +235,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         w7 = MyWidget7()\n         self.assertEqual(\n             str(w7.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n@@ -253,9 +253,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         w8 = MyWidget8()\n         self.assertEqual(\n             str(w8.media),\n-            \"\"\"<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -287,8 +287,8 @@ class FormsMediaTestCase(SimpleTestCase):\n         w9 = MyWidget9()\n         self.assertEqual(\n             str(w9.media),\n-            \"\"\"<link href=\"/some/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/other/path\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"/some/path\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/other/path\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/some/js\"></script>\n <script src=\"/other/js\"></script>\"\"\"\n         )\n@@ -303,8 +303,8 @@ class FormsMediaTestCase(SimpleTestCase):\n                 js = ('/path/to/js1', '/path/to/js4')\n \n         w10 = MyWidget10()\n-        self.assertEqual(str(w10.media), \"\"\"<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+        self.assertEqual(str(w10.media), \"\"\"<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"/path/to/js4\"></script>\"\"\")\n \n@@ -328,9 +328,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         w11 = MyWidget11()\n         self.assertEqual(\n             str(w11.media),\n-            \"\"\"<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -357,9 +357,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         w12 = MyWidget12()\n         self.assertEqual(\n             str(w12.media),\n-            \"\"\"<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"/path/to/js4\"></script>\"\"\"\n         )\n@@ -382,10 +382,10 @@ class FormsMediaTestCase(SimpleTestCase):\n         multimedia = MultimediaWidget()\n         self.assertEqual(\n             str(multimedia.media),\n-            \"\"\"<link href=\"/file4\" type=\"text/css\" media=\"print\" rel=\"stylesheet\">\n-<link href=\"/file3\" type=\"text/css\" media=\"screen\" rel=\"stylesheet\">\n-<link href=\"/file1\" type=\"text/css\" media=\"screen, print\" rel=\"stylesheet\">\n-<link href=\"/file2\" type=\"text/css\" media=\"screen, print\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"/file4\" media=\"print\" rel=\"stylesheet\">\n+<link href=\"/file3\" media=\"screen\" rel=\"stylesheet\">\n+<link href=\"/file1\" media=\"screen, print\" rel=\"stylesheet\">\n+<link href=\"/file2\" media=\"screen, print\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"/path/to/js4\"></script>\"\"\"\n         )\n@@ -426,9 +426,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         mymulti = MyMultiWidget()\n         self.assertEqual(\n             str(mymulti.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -468,9 +468,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         f1 = MyForm()\n         self.assertEqual(\n             str(f1.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -483,9 +483,9 @@ class FormsMediaTestCase(SimpleTestCase):\n         f2 = AnotherForm()\n         self.assertEqual(\n             str(f1.media + f2.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n@@ -505,10 +505,10 @@ class FormsMediaTestCase(SimpleTestCase):\n         f3 = FormWithMedia()\n         self.assertEqual(\n             str(f3.media),\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/some/form/css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/some/form/css\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"/some/form/javascript\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n@@ -524,10 +524,10 @@ class FormsMediaTestCase(SimpleTestCase):\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"/path/to/js4\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\n-            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/some/form/css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css3\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\"\"\"\n+            \"\"\"<link href=\"http://media.example.com/static/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/some/form/css\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css3\" media=\"all\" rel=\"stylesheet\">\"\"\"\n         )\n \n     def test_html_safe(self):\ndiff --git a/tests/model_forms/tests.py b/tests/model_forms/tests.py\nindex 0307569c12..db36216d14 100644\n--- a/tests/model_forms/tests.py\n+++ b/tests/model_forms/tests.py\n@@ -2485,8 +2485,8 @@ class OtherModelFormTests(TestCase):\n         f = ModelFormWithMedia()\n         self.assertHTMLEqual(\n             str(f.media),\n-            '''<link href=\"/some/form/css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<script src=\"/some/form/javascript\"></script>'''\n+            '<link href=\"/some/form/css\" media=\"all\" rel=\"stylesheet\">'\n+            '<script src=\"/some/form/javascript\"></script>'\n         )\n \n     def test_choices_type(self):\ndiff --git a/tests/staticfiles_tests/test_forms.py b/tests/staticfiles_tests/test_forms.py\nindex 1fbcbe164c..fadbe6e1d5 100644\n--- a/tests/staticfiles_tests/test_forms.py\n+++ b/tests/staticfiles_tests/test_forms.py\n@@ -29,8 +29,8 @@ class StaticFilesFormsMediaTestCase(SimpleTestCase):\n         )\n         self.assertEqual(\n             str(m),\n-            \"\"\"<link href=\"https://example.com/assets/path/to/css1\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n-<link href=\"/path/to/css2\" type=\"text/css\" media=\"all\" rel=\"stylesheet\">\n+            \"\"\"<link href=\"https://example.com/assets/path/to/css1\" media=\"all\" rel=\"stylesheet\">\n+<link href=\"/path/to/css2\" media=\"all\" rel=\"stylesheet\">\n <script src=\"/path/to/js1\"></script>\n <script src=\"http://media.other.com/path/to/js2\"></script>\n <script src=\"https://secure.other.com/path/to/js3\"></script>\ndiff --git a/django/contrib/messages/storage/cookie.py b/django/contrib/messages/storage/cookie.py\nindex 1d390c71dd..e48d4edb08 100644\n--- a/django/contrib/messages/storage/cookie.py\n+++ b/django/contrib/messages/storage/cookie.py\n@@ -19,7 +19,7 @@ class MessageEncoder(json.JSONEncoder):\n             # Using 0/1 here instead of False/True to produce more compact json\n             is_safedata = 1 if isinstance(obj.message, SafeData) else 0\n             message = [self.message_key, is_safedata, obj.level, obj.message]\n-            if obj.extra_tags:\n+            if obj.extra_tags is not None:\n                 message.append(obj.extra_tags)\n             return message\n         return super().default(obj)\nObtaining file:///testbed\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Checking if build backend supports build_editable: started\n  Checking if build backend supports build_editable: finished with status 'done'\n  Getting requirements to build editable: started\n  Getting requirements to build editable: finished with status 'done'\n  Preparing editable metadata (pyproject.toml): started\n  Preparing editable metadata (pyproject.toml): finished with status 'done'\nRequirement already satisfied: asgiref>=3.4.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from Django==4.1.dev20220122153814) (3.8.1)\nRequirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from Django==4.1.dev20220122153814) (0.5.1)\nRequirement already satisfied: typing-extensions>=4 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from asgiref>=3.4.1->Django==4.1.dev20220122153814) (4.12.2)\nBuilding wheels for collected packages: Django\n  Building editable for Django (pyproject.toml): started\n  Building editable for Django (pyproject.toml): finished with status 'done'\n  Created wheel for Django: filename=Django-4.1.dev20220122153814-0.editable-py3-none-any.whl size=26916 sha256=2043fd68cc026a7c55289f63bc7fb261748e72954abebb0678a74eaf40669576\n  Stored in directory: /tmp/pip-ephem-wheel-cache-esx_0z45/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4\nSuccessfully built Django\nInstalling collected packages: Django\n  Attempting uninstall: Django\n    Found existing installation: Django 4.1.dev20220122153814\n    Uninstalling Django-4.1.dev20220122153814:\n      Successfully uninstalled Django-4.1.dev20220122153814\nSuccessfully installed Django-4.1.dev20220122153814\nTesting against Django installed in '/testbed/django'\nImporting application messages_tests\nFound 30 test(s).\nSkipping setup of unused database(s): default, other.\nSystem check identified no issues (0 silenced).\n", {}]