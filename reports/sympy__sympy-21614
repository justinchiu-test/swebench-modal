[{"repo": "sympy/sympy", "instance_id": "sympy__sympy-21614", "base_commit": "b4777fdcef467b7132c055f8ac2c9a5059e6a145", "patch": "diff --git a/sympy/core/function.py b/sympy/core/function.py\n--- a/sympy/core/function.py\n+++ b/sympy/core/function.py\n@@ -1707,6 +1707,10 @@ def free_symbols(self):\n             ret.update(count.free_symbols)\n         return ret\n \n+    @property\n+    def kind(self):\n+        return self.args[0].kind\n+\n     def _eval_subs(self, old, new):\n         # The substitution (old, new) cannot be done inside\n         # Derivative(expr, vars) for a variety of reasons\n", "test_patch": "diff --git a/sympy/core/tests/test_kind.py b/sympy/core/tests/test_kind.py\n--- a/sympy/core/tests/test_kind.py\n+++ b/sympy/core/tests/test_kind.py\n@@ -5,6 +5,7 @@\n from sympy.core.singleton import S\n from sympy.core.symbol import Symbol\n from sympy.integrals.integrals import Integral\n+from sympy.core.function import Derivative\n from sympy.matrices import (Matrix, SparseMatrix, ImmutableMatrix,\n     ImmutableSparseMatrix, MatrixSymbol, MatrixKind, MatMul)\n \n@@ -39,6 +40,11 @@ def test_Integral_kind():\n     assert Integral(comm_x, comm_x).kind is NumberKind\n     assert Integral(A, comm_x).kind is MatrixKind(NumberKind)\n \n+def test_Derivative_kind():\n+    A = MatrixSymbol('A', 2,2)\n+    assert Derivative(comm_x, comm_x).kind is NumberKind\n+    assert Derivative(A, comm_x).kind is MatrixKind(NumberKind)\n+\n def test_Matrix_kind():\n     classes = (Matrix, SparseMatrix, ImmutableMatrix, ImmutableSparseMatrix)\n     for cls in classes:\n", "problem_statement": "Wrong Derivative kind attribute\nI'm playing around with the `kind` attribute.\r\n\r\nThe following is correct:\r\n\r\n```\r\nfrom sympy import Integral, Derivative\r\nfrom sympy import MatrixSymbol\r\nfrom sympy.abc import x\r\nA = MatrixSymbol('A', 2, 2)\r\ni = Integral(A, x)\r\ni.kind\r\n# MatrixKind(NumberKind)\r\n```\r\n\r\nThis one is wrong:\r\n```\r\nd = Derivative(A, x)\r\nd.kind\r\n# UndefinedKind\r\n```\n", "hints_text": "As I dig deeper into this issue, the problem is much larger than `Derivative`. As a matter of facts, all functions should be able to deal with `kind`. At the moment:\r\n\r\n```\r\nfrom sympy import MatrixSymbol\r\nA = MatrixSymbol('A', 2, 2)\r\nsin(A).kind\r\n# UndefinedKind\r\n```\nThe kind attribute is new and is not fully implemented or used across the codebase.\r\n\r\nFor `sin` and other functions I don't think that we should allow the ordinary `sin` function to be used for the Matrix sin. There should be a separate `MatrixSin` function for that.\r\n\r\nFor Derivative the handler for kind just needs to be added.", "created_at": "2021-06-14T07:56:59Z", "version": "1.9", "FAIL_TO_PASS": "[\"test_Derivative_kind\"]", "PASS_TO_PASS": "[\"test_NumberKind\", \"test_Add_kind\", \"test_mul_kind\", \"test_Symbol_kind\", \"test_Integral_kind\", \"test_Matrix_kind\"]", "environment_setup_commit": "f9a6f50ec0c74d935c50a6e9c9b2cb0469570d91"}, "On branch master\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   sympy/core/function.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit b4777fdcef467b7132c055f8ac2c9a5059e6a145\nMerge: 47e86081be 495e2c3236\nAuthor: Oscar Benjamin <oscar.j.benjamin@gmail.com>\nDate:   Sun Jun 13 14:23:08 2021 +0100\n\n    Merge pull request #21607 from oscarbenjamin/pr_pythonsat\n    \n    maint(ci): don't test python-sat in Travis\n\ndiff --git a/sympy/core/function.py b/sympy/core/function.py\nindex 69df976b8b..20a4588b39 100644\n--- a/sympy/core/function.py\n+++ b/sympy/core/function.py\n@@ -1707,6 +1707,10 @@ def free_symbols(self):\n             ret.update(count.free_symbols)\n         return ret\n \n+    @property\n+    def kind(self):\n+        return self.args[0].kind\n+\n     def _eval_subs(self, old, new):\n         # The substitution (old, new) cannot be done inside\n         # Derivative(expr, vars) for a variety of reasons\nObtaining file:///testbed\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nRequirement already satisfied: mpmath>=0.19 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from sympy==1.9.dev0) (1.3.0)\nInstalling collected packages: sympy\n  Attempting uninstall: sympy\n    Found existing installation: sympy 1.9.dev0\n    Uninstalling sympy-1.9.dev0:\n      Successfully uninstalled sympy-1.9.dev0\n  Running setup.py develop for sympy\nSuccessfully installed sympy\n============================= test process starts ==============================\nexecutable:         /opt/miniconda3/envs/testbed/bin/python  (3.9.20-final-0) [CPython]\narchitecture:       64-bit\ncache:              no\nground types:       python \nnumpy:              None\nrandom seed:        72144251\nhash randomization: off\n\nsympy/core/tests/test_kind.py[8] \ntest_NumberKind ok\ntest_Add_kind ok\ntest_mul_kind ok\ntest_Symbol_kind ok\ntest_Integral_kind ok\ntest_Derivative_kind ok\ntest_Matrix_kind ok\ntest_MatMul_kind ok                                                         [OK]\n\n\n================== tests finished: 8 passed, in 0.09 seconds ===================\n", {"test_NumberKind": "PASSED", "test_Add_kind": "PASSED", "test_mul_kind": "PASSED", "test_Symbol_kind": "PASSED", "test_Integral_kind": "PASSED", "test_Derivative_kind": "PASSED", "test_Matrix_kind": "PASSED"}]